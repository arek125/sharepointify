import{a as Ue,u as je,d as Ze,b as Re,V as Gt}from"./VSpacer-c35aaf9f.js";import{Q as ze,R as nt,t as ie,S as Ve,T as Ee,y as ue,c as R,U as Jt,W as He,X as ot,Y as ut,Z as it,z as ye,$ as st,a0 as Xe,r as V,w as Q,D as se,a1 as Ge,a2 as be,a3 as rt,i as a,a4 as dt,C as ee,F as K,a5 as ct,a6 as ft,G as De,a7 as ge,a8 as vt,d as ne,o as $,a as z,b as h,f as Fe,h as Ae,L as Ie,V as he,j as de,g as Je,_ as oe,q as Ne,s as X,a9 as Yt,aa as Ye,ab as _e,ac as mt,ad as Be,ae as $e,af as pt,ag as yt,ah as gt,ai as Kt,aj as bt,ak as It,al as ht,am as Wt,an as _t,ao as Qt,ap as Zt,aq as Vt,ar as kt,as as Xt,at as el,au as Ct,av as St,aw as tl,ax as wt,ay as Ft,az as At,aA as ll,m as Le,aB as xt,aC as al,aD as nl,aE as ol,aF as ul,aG as il,H as xe,aH as Pt,I as Tt,N as Ut,aI as sl,J as S,aJ as Oe,aK as rl,aL as dl,aM as Rt,aN as cl,aO as fl,u as $t,aP as vl,aQ as ml,aR as pe,aS as pl,aT as yl,aU as gl,aV as bl,aW as et,aX as Il,aY as hl,n as qe,aZ as _l,a_ as Vl,k as kl,a$ as Cl,b0 as tt,l as qt,b1 as Ke,O as Sl,b2 as wl,b3 as Fl,b4 as Al,b5 as xl,b6 as Pl,b7 as Tl,b8 as Dt,b9 as Ul,B as Rl,ba as $l,bb as ql,bc as Dl,bd as Nl,be as Ml,bf as Bl,bg as Ll}from"./index-0545ea52.js";const Nt=(()=>ze.reduce((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e),{}))(),Mt=(()=>ze.reduce((e,t)=>{const l="offset"+nt(t);return e[l]={type:[String,Number],default:null},e},{}))(),Bt=(()=>ze.reduce((e,t)=>{const l="order"+nt(t);return e[l]={type:[String,Number],default:null},e},{}))(),lt={col:Object.keys(Nt),offset:Object.keys(Mt),order:Object.keys(Bt)};function Ol(e,t,l){let o=e;if(!(l==null||l===!1)){if(t){const n=t.replace(e,"");o+=`-${n}`}return e==="col"&&(o="v-"+o),e==="col"&&(l===""||l===!0)||(o+=`-${l}`),o.toLowerCase()}}const jl=["auto","start","end","center","baseline","stretch"],zl=ie({cols:{type:[Boolean,String,Number],default:!1},...Nt,offset:{type:[String,Number],default:null},...Mt,order:{type:[String,Number],default:null},...Bt,alignSelf:{type:String,default:null,validator:e=>jl.includes(e)},...Ve(),...Ee()},"VCol"),j=ue()({name:"VCol",props:zl(),setup(e,t){let{slots:l}=t;const o=R(()=>{const n=[];let u;for(u in lt)lt[u].forEach(d=>{const c=e[d],f=Ol(u,d,c);f&&n.push(f)});const i=n.some(d=>d.startsWith("v-col-"));return n.push({"v-col":!i||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),n});return()=>{var n;return Jt(e.tag,{class:[o.value,e.class],style:e.style},(n=l.default)==null?void 0:n.call(l))}}});const El=ie({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...He({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>ot(e).every(t=>t!=null&&typeof t=="object")},...ut({clearable:!0})},"VFileInput"),Hl=ue()({name:"VFileInput",inheritAttrs:!1,props:El(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:l,emit:o,slots:n}=t;const{t:u}=it(),i=ye(e,"modelValue"),{isFocused:d,focus:c,blur:f}=st(e),g=R(()=>typeof e.showSize!="boolean"?e.showSize:void 0),b=R(()=>(i.value??[]).reduce((I,F)=>{let{size:A=0}=F;return I+A},0)),y=R(()=>Xe(b.value,g.value)),x=R(()=>(i.value??[]).map(I=>{const{name:F="",size:A=0}=I;return e.showSize?`${F} (${Xe(A,g.value)})`:F})),r=R(()=>{var F;const I=((F=i.value)==null?void 0:F.length)??0;return e.showSize?u(e.counterSizeString,I,y.value):u(e.counterString,I)}),s=V(),v=V(),_=V(),k=R(()=>d.value||e.active),p=R(()=>["plain","underlined"].includes(e.variant));function w(){var I;_.value!==document.activeElement&&((I=_.value)==null||I.focus()),d.value||c()}function M(I){P(I)}function B(I){o("mousedown:control",I)}function P(I){var F;(F=_.value)==null||F.click(),o("click:control",I)}function U(I){I.stopPropagation(),w(),ge(()=>{i.value=[],vt(e["onClick:clear"],I)})}return Q(i,I=>{(!Array.isArray(I)||!I.length)&&_.value&&(_.value.value="")}),se(()=>{const I=!!(n.counter||e.counter),F=!!(I||n.details),[A,O]=Ge(l),[{modelValue:q,...Y}]=be.filterProps(e),[C]=rt(e);return a(be,ee({ref:s,modelValue:i.value,"onUpdate:modelValue":E=>i.value=E,class:["v-file-input",{"v-text-field--plain-underlined":p.value},e.class],style:e.style,"onClick:prepend":M},A,Y,{centerAffix:!p.value,focused:d.value}),{...n,default:E=>{let{id:H,isDisabled:D,isDirty:G,isReadonly:W,isValid:ke}=E;return a(dt,ee({ref:v,"prepend-icon":e.prependIcon,onMousedown:B,onClick:P,"onClick:clear":U,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},C,{id:H.value,active:k.value||G.value,dirty:G.value,disabled:D.value,focused:d.value,error:ke.value===!1}),{...n,default:Ce=>{var ce;let{props:{class:Se,...me}}=Ce;return a(K,null,[a("input",ee({ref:_,type:"file",readonly:W.value,disabled:D.value,multiple:e.multiple,name:e.name,onClick:te=>{te.stopPropagation(),W.value&&te.preventDefault(),w()},onChange:te=>{if(!te.target)return;const Me=te.target;i.value=[...Me.files??[]]},onFocus:w,onBlur:f},me,O),null),a("div",{class:Se},[!!((ce=i.value)!=null&&ce.length)&&(n.selection?n.selection({fileNames:x.value,totalBytes:b.value,totalBytesReadable:y.value}):e.chips?x.value.map(te=>a(ct,{key:te,size:"small",color:e.color},{default:()=>[te]})):x.value.join(", "))])])}})},details:F?E=>{var H,D;return a(K,null,[(H=n.details)==null?void 0:H.call(n,E),I&&a(K,null,[a("span",null,null),a(ft,{active:!!((D=i.value)!=null&&D.length),value:r.value},n.counter)])])}:void 0})}),De({},s,v,_)}}),Gl=ne({__name:"attachmentsUpload",props:{disabled:{type:Boolean,required:!1,default:!1}},emits:["update:filesToUpload"],setup(e,{emit:t}){const l=e,o=V([]);return Q(o.value,n=>{t("update:filesToUpload",n)}),(n,u)=>l.disabled?Je("",!0):($(),z(Ue,{key:0},{default:h(()=>[($(!0),Fe(K,null,Ae(o.value,(i,d)=>($(),z(j,{cols:"12",lg:"6",key:d},{default:h(()=>[a(Hl,{modelValue:o.value[d],"onUpdate:modelValue":c=>o.value[d]=c,label:"Attachments "+(d+1),multiple:"","prepend-icon":"mdi-paperclip","append-outer-icon":"mdi-delete","onClick:appendOuter":c=>o.value.splice(d,1),"small-chips":""},null,8,["modelValue","onUpdate:modelValue","label","onClick:appendOuter"])]),_:2},1024))),128)),a(j,{cols:"6"},{default:h(()=>[a(Ie,{color:"primary",onClick:u[0]||(u[0]=i=>o.value.push([])),tile:""},{default:h(()=>[a(he,{left:""},{default:h(()=>[de(" mdi-paperclip ")]),_:1}),de("Add next attachments ")]),_:1})]),_:1})]),_:1}))}}),Jl=oe(Gl,[["__file","attachmentsUpload.vue"]]),Lt=(e,t,l)=>{const o=Ne("$mainUrl"),n=V([]),{parseJsonTofield:u,getListColumnsInfo:i}=je(),d=R(()=>{var r;return(r=n.value)==null?void 0:r.map(s=>s.staticName)}),c=V([]),f=V([]),g=V(!0),b=r=>n.value.find(s=>s.staticName==r),y=async r=>{const s=await X.get(o+"/_api/web/lists/getbytitle('"+e+"')/items",{params:{$expand:["Author","Editor","AttachmentFiles"].join(","),$select:["Id","Created","Author/Title","Author/Id","Editor/Title","Editor/Id","Modified","AttachmentFiles/FileName","AttachmentFiles/ServerRelativeUrl"].join(","),$filter:r,$top:100}});s.data.value.length&&(c.value=s.data.value.map(p=>({id:p.Id,created:Ze(p.Created).format("YYYY-MM-DD HH:mm"),author:p.Author,modified:Ze(p.Modified).format("YYYY-MM-DD HH:mm"),editor:p.Editor,attachmentFiles:p.AttachmentFiles})));let v,_,k=12;for(v=0,_=t.length;v<_;v+=k){let p=t.slice(v,v+k),w=p.map(P=>{let U=n.value.find(I=>I.staticName==P);if(!U)throw"Column"+P+" not found";return U.type=="User"||U.type=="UserMulti"||U.type=="Lookup"||U.type=="LookupMulti"?P+"/Id,"+P+"/Title":P}),M=p.filter(P=>{let U=n.value.find(I=>I.staticName==P);if(!U)throw"Column"+P+" not found";return U.type=="User"||U.type=="UserMulti"||U.type=="Lookup"||U.type=="LookupMulti"});const B=await X.get(o+"/_api/web/lists/getbytitle('"+e+"')/items",{params:{$expand:M.length?M.join(","):void 0,$select:w.join(","),$filter:r,$top:100}});if(B.data.value.length)for(let P=0;P<B.data.value.length;P++)for(let U of p){let I=n.value.find(A=>A.staticName==U);if(!I)throw"Column"+U+"not found";let F=u(B.data.value[P][U],I);f.value[P]=Object.assign({},f.value[P],{[U]:JSON.parse(JSON.stringify(F))})}}};return{columnNames:d,columns:n,initLoading:g,readOnlyFields:c,editableFields:f,initForm:async()=>{n.value=await i(e),l?await y(l):(f.value.push(t.reduce((r,s)=>({...r,[s]:null}),{})),c.value.push({id:-1})),g.value=!1},getCol:b}};const Ot=ue()({name:"VCardActions",props:Ve(),setup(e,t){let{slots:l}=t;return Yt({VBtn:{variant:"text"}}),se(()=>{var o;return a("div",{class:["v-card-actions",e.class],style:e.style},[(o=l.default)==null?void 0:o.call(l)])}),{}}}),Yl=Ye("v-card-subtitle"),jt=Ye("v-card-title"),Kl=ie({appendAvatar:String,appendIcon:_e,prependAvatar:String,prependIcon:_e,subtitle:String,title:String,...Ve(),...mt()},"VCardItem"),Wl=ue()({name:"VCardItem",props:Kl(),setup(e,t){let{slots:l}=t;return se(()=>{var f;const o=!!(e.prependAvatar||e.prependIcon),n=!!(o||l.prepend),u=!!(e.appendAvatar||e.appendIcon),i=!!(u||l.append),d=!!(e.title||l.title),c=!!(e.subtitle||l.subtitle);return a("div",{class:["v-card-item",e.class],style:e.style},[n&&a("div",{key:"prepend",class:"v-card-item__prepend"},[l.prepend?a($e,{key:"prepend-defaults",disabled:!o,defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar}}},l.prepend):o&&a(Be,{key:"prepend-avatar",density:e.density,icon:e.prependIcon,image:e.prependAvatar},null)]),a("div",{class:"v-card-item__content"},[d&&a(jt,{key:"title"},{default:()=>{var g;return[((g=l.title)==null?void 0:g.call(l))??e.title]}}),c&&a(Yl,{key:"subtitle"},{default:()=>{var g;return[((g=l.subtitle)==null?void 0:g.call(l))??e.subtitle]}}),(f=l.default)==null?void 0:f.call(l)]),i&&a("div",{key:"append",class:"v-card-item__append"},[l.append?a($e,{key:"append-defaults",disabled:!u,defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar}}},l.append):u&&a(Be,{key:"append-avatar",density:e.density,icon:e.appendIcon,image:e.appendAvatar},null)])])}),{}}}),Ql=Ye("v-card-text"),Zl=ie({appendAvatar:String,appendIcon:_e,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:_e,ripple:{type:[Boolean,Object],default:!0},subtitle:String,text:String,title:String,...pt(),...Ve(),...mt(),...yt(),...gt(),...Kt(),...bt(),...It(),...ht(),...Wt(),...Ee(),..._t(),...Qt({variant:"elevated"})},"VCard"),Xl=ue()({name:"VCard",directives:{Ripple:Zt},props:Zl(),setup(e,t){let{attrs:l,slots:o}=t;const{themeClasses:n}=Vt(e),{borderClasses:u}=kt(e),{colorClasses:i,colorStyles:d,variantClasses:c}=Xt(e),{densityClasses:f}=el(e),{dimensionStyles:g}=Ct(e),{elevationClasses:b}=St(e),{loaderClasses:y}=tl(e),{locationStyles:x}=wt(e),{positionClasses:r}=Ft(e),{roundedClasses:s}=At(e),v=ll(e,l),_=R(()=>e.link!==!1&&v.isLink.value),k=R(()=>!e.disabled&&e.link!==!1&&(e.link||v.isClickable.value));return se(()=>{const p=_.value?"a":e.tag,w=!!(o.title||e.title),M=!!(o.subtitle||e.subtitle),B=w||M,P=!!(o.append||e.appendAvatar||e.appendIcon),U=!!(o.prepend||e.prependAvatar||e.prependIcon),I=!!(o.image||e.image),F=B||U||P,A=!!(o.text||e.text);return Le(a(p,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":k.value},n.value,u.value,i.value,f.value,b.value,y.value,r.value,s.value,c.value,e.class],style:[d.value,g.value,x.value,e.style],href:v.href.value,onClick:k.value&&v.navigate,tabindex:e.disabled?-1:void 0},{default:()=>{var O;return[I&&a("div",{key:"image",class:"v-card__image"},[o.image?a($e,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},o.image):a(al,{key:"image-img",cover:!0,src:e.image},null)]),a(nl,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:o.loader}),F&&a(Wl,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:o.item,prepend:o.prepend,title:o.title,subtitle:o.subtitle,append:o.append}),A&&a(Ql,{key:"text"},{default:()=>{var q;return[((q=o.text)==null?void 0:q.call(o))??e.text]}}),(O=o.default)==null?void 0:O.call(o),o.actions&&a(Ot,null,{default:o.actions}),ol(k.value,"v-card")]}}),[[xt("ripple"),k.value&&e.ripple]])}),{}}});const ea=ie({color:String,...pt(),...Ve(),...yt(),...gt(),...bt(),...It(),...ht(),...Ee(),..._t()},"VSheet"),ta=ue()({name:"VSheet",props:ea(),setup(e,t){let{slots:l}=t;const{themeClasses:o}=Vt(e),{backgroundColorClasses:n,backgroundColorStyles:u}=ul(il(e,"color")),{borderClasses:i}=kt(e),{dimensionStyles:d}=Ct(e),{elevationClasses:c}=St(e),{locationStyles:f}=wt(e),{positionClasses:g}=Ft(e),{roundedClasses:b}=At(e);return se(()=>a(e.tag,{class:["v-sheet",o.value,n.value,i.value,c.value,g.value,b.value,e.class],style:[u.value,d.value,f.value,e.style]},l)),{}}}),la=ne({__name:"dataIterator",props:{listName:{type:String,required:!0},queryFilter:{type:String,required:!0},lookupColumn:{type:String,required:!0},keyColumn:{type:String,required:!0},parentId:{type:Number,required:!1},readonly:{type:Boolean,required:!0},editableColumns:{type:Array,required:!0}},setup(e,{expose:t}){const l=e,{readOnlyFields:o,editableFields:n,initForm:u,getCol:i,columns:d}=Lt(l.listName,l.editableColumns,l.parentId?l.queryFilter+l.parentId:void 0),c=V([]),f=V([]),g=V(!1);xe(async()=>{if(await u(),console.log(n.value,o.value),n.value.length)for(const[r,s]of n.value.entries())c.value.push(Object.assign({},Pt(s),{id:o.value[r].id}));console.log(c.value),g.value=!0});const b=()=>{c.value.push(l.editableColumns.reduce((r,s)=>({...r,[s]:null,id:-1}),{}))},y=(r,s,v)=>{typeof r=="object"&&r.target||(c.value[s][v]=r)},x=r=>{c.value[r].id!=-1&&f.value.push(c.value[r].id),c.value.splice(r,1)};return Q(c.value,r=>{console.log(r)}),t({mainItems:c,deletedItems:f,props:l,columns:d}),(r,s)=>{const v=Tt("v-data-iterator");return g.value?($(),z(v,{key:0,items:c.value},{header:h(()=>[a(jt,{class:"subheading font-weight-bold"},{default:h(()=>[de(Ut(l.listName),1)]),_:1})]),"no-data":h(()=>[a(he,null,{default:h(()=>[de("mdi-alert")]),_:1}),de(" No items ")]),default:h(({items:_})=>[a(Re,{fluid:""},{default:h(()=>[a(Ue,{dense:""},{default:h(()=>[($(!0),Fe(K,null,Ae(_,(k,p)=>($(),z(j,{key:p,cols:"12"},{default:h(()=>[a(ta,{rounded:"10",color:"grey-lighten-3"},{default:h(()=>[a(Re,{fluid:""},{default:h(()=>[a(Ue,{dense:""},{default:h(()=>[($(!0),Fe(K,null,Ae(l.editableColumns,w=>sl(r.$slots,w,{key:w,value:k.raw[w],index:p,column:S(i)(w),update:y})),128)),a(j,{cols:"1","align-self":"center"},{default:h(()=>[a(Ie,{icon:"",color:"grey",class:"float-right",onClick:w=>x(p),disabled:e.readonly},{default:h(()=>[a(he,{large:""},{default:h(()=>[de("mdi-delete")]),_:1})]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),footer:h(()=>[a(Ie,{icon:"mdi-plus",size:"large",onClick:b})]),_:3},8,["items"])):Je("",!0)}}}),aa=oe(la,[["__file","dataIterator.vue"]]),na=ne({__name:"attachmentsList",props:{disabled:{type:Boolean,required:!1,default:!1},savedFiles:{type:Array}},emits:["update:filesToRemove"],setup(e,{emit:t}){const l=e,{openExternalLink:o}=je(),n=V([]);Q(n.value,d=>{t("update:filesToRemove",d)});const u=d=>{const c=n.value.indexOf(d);n.value.splice(c,1)},i=d=>n.value.includes(d);return(d,c)=>($(),z(Rt,{lines:"one"},{default:h(()=>[($(!0),Fe(K,null,Ae(l.savedFiles,f=>($(),z(Oe,{key:f.FileName},{prepend:h(()=>[a(Be,{color:f.color},{default:h(()=>[a(he,{color:"primary"},{default:h(()=>[de("mdi-attachment")]),_:1})]),_:2},1032,["color"])]),append:h(()=>[a(Ie,{color:"grey-lighten-1",icon:"mdi-open-in-new",variant:"text",onClick:g=>S(o)(f.ServerRelativeUrl)},null,8,["onClick"]),a(Ie,{color:"grey-lighten-1",icon:"mdi-delete",variant:"text",onClick:g=>i(f.FileName)?u(f):n.value.push(f.FileName)},null,8,["onClick"])]),default:h(()=>[a(rl,{textContent:Ut(f.FileName),style:dl({"text-decoration":i(f.FileName)?"line-through":"auto"})},null,8,["textContent","style"])]),_:2},1024))),128))]),_:1}))}}),oa=oe(na,[["__file","attachmentsList.vue"]]);function ua(e,t,l){if(t==null)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return typeof t=="number"&&~t?a(K,null,[a("span",{class:"v-autocomplete__unmask"},[e.substr(0,t)]),a("span",{class:"v-autocomplete__mask"},[e.substr(t,l)]),a("span",{class:"v-autocomplete__unmask"},[e.substr(t+l)])]):e}const ia=ie({autoSelectFirst:{type:[Boolean,String]},search:String,...cl({filterKeys:["title"]}),...fl(),...$t(vl({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...ml({transition:!1})},"VAutocomplete"),zt=ue()({name:"VAutocomplete",props:ia(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:l}=t;const{t:o}=it(),n=V(),u=pe(!1),i=pe(!0),d=pe(!1),c=V(),f=V(),g=ye(e,"menu"),b=R({get:()=>g.value,set:m=>{var T;g.value&&!m&&((T=c.value)!=null&&T.ΨopenChildren)||(g.value=m)}}),y=pe(-1),x=R(()=>{var m;return(m=n.value)==null?void 0:m.color}),r=R(()=>b.value?e.closeText:e.openText),{items:s,transformIn:v,transformOut:_}=pl(e),{textColorClasses:k,textColorStyles:p}=yl(x),w=ye(e,"search",""),M=ye(e,"modelValue",[],m=>v(m===null?[null]:ot(m)),m=>{const T=_(m);return e.multiple?T:T[0]??null}),B=gl(),{filteredItems:P,getMatches:U}=bl(e,s,()=>i.value?"":w.value),I=R(()=>M.value.map(m=>s.value.find(T=>{const L=et(T.raw,e.itemValue),re=et(m.raw,e.itemValue);return L===void 0||re===void 0?!1:e.returnObject?e.valueComparator(L,re):e.valueComparator(T.value,m.value)})||m)),F=R(()=>e.hideSelected?P.value.filter(m=>!I.value.some(T=>T.value===m.value)):P.value),A=R(()=>I.value.map(m=>m.props.value)),O=R(()=>I.value[y.value]),q=R(()=>{var T;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&w.value===((T=F.value[0])==null?void 0:T.title))&&F.value.length>0&&!i.value&&!d.value}),Y=R(()=>e.hideNoData&&!s.value.length||e.readonly||(B==null?void 0:B.isReadonly.value)),C=V(),{onListScroll:E,onListKeydown:H}=Il(C,n);function D(m){e.openOnClear&&(b.value=!0),w.value=""}function G(){Y.value||(b.value=!0)}function W(m){Y.value||(u.value&&(m.preventDefault(),m.stopPropagation()),b.value=!b.value)}function ke(m){var re,N,Z;if(e.readonly||B!=null&&B.isReadonly.value)return;const T=n.value.selectionStart,L=A.value.length;if((y.value>-1||["Enter","ArrowDown","ArrowUp"].includes(m.key))&&m.preventDefault(),["Enter","ArrowDown"].includes(m.key)&&(b.value=!0),["Escape"].includes(m.key)&&(b.value=!1),q.value&&["Enter","Tab"].includes(m.key)&&fe(F.value[0]),m.key==="ArrowDown"&&q.value&&((re=C.value)==null||re.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(m.key)){if(y.value<0){m.key==="Backspace"&&!w.value&&(y.value=L-1);return}const J=y.value;O.value&&fe(O.value),y.value=J>=L-1?L-2:J}if(m.key==="ArrowLeft"){if(y.value<0&&T>0)return;const J=y.value>-1?y.value-1:L-1;I.value[J]?y.value=J:(y.value=-1,n.value.setSelectionRange((N=w.value)==null?void 0:N.length,(Z=w.value)==null?void 0:Z.length))}if(m.key==="ArrowRight"){if(y.value<0)return;const J=y.value+1;I.value[J]?y.value=J:(y.value=-1,n.value.setSelectionRange(0,0))}}}function Ce(m){w.value=m.target.value}function Se(m){if(tt(n.value,":autofill")||tt(n.value,":-webkit-autofill")){const T=s.value.find(L=>L.title===m.target.value);T&&fe(T)}}function me(){var m;u.value&&(i.value=!0,(m=n.value)==null||m.focus())}function ce(m){u.value=!0,setTimeout(()=>{d.value=!0})}function te(m){d.value=!1}function Me(m){(m==null||m===""&&!e.multiple)&&(M.value=[])}const we=pe(!1);function fe(m){if(e.multiple){const T=A.value.findIndex(L=>e.valueComparator(L,m.value));if(T===-1)M.value=[...M.value,m];else{const L=[...M.value];L.splice(T,1),M.value=L}}else M.value=[m],we.value=!0,w.value=m.title,b.value=!1,i.value=!0,ge(()=>we.value=!1)}return Q(u,(m,T)=>{var L;m!==T&&(m?(we.value=!0,w.value=e.multiple?"":String(((L=I.value.at(-1))==null?void 0:L.props.title)??""),i.value=!0,ge(()=>we.value=!1)):(!e.multiple&&!w.value?M.value=[]:q.value&&!d.value&&!I.value.some(re=>{let{value:N}=re;return N===F.value[0].value})&&fe(F.value[0]),b.value=!1,w.value="",y.value=-1))}),Q(w,m=>{!u.value||we.value||(m&&(b.value=!0),i.value=!m)}),Q(b,()=>{if(!e.hideSelected&&b.value&&I.value.length){const m=F.value.findIndex(T=>I.value.some(L=>T.value===L.value));hl&&window.requestAnimationFrame(()=>{var T;m>=0&&((T=f.value)==null||T.scrollToIndex(m))})}}),se(()=>{const m=!!(e.chips||l.chip),T=!!(!e.hideNoData||F.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),L=M.value.length>0,[re]=qe.filterProps(e);return a(qe,ee({ref:n},re,{modelValue:w.value,"onUpdate:modelValue":Me,focused:u.value,"onUpdate:focused":N=>u.value=N,validationValue:M.externalValue,dirty:L,onInput:Ce,onChange:Se,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":b.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!l.selection,"v-autocomplete--selecting-index":y.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:L?void 0:e.placeholder,"onClick:clear":D,"onMousedown:control":G,onKeydown:ke}),{...l,default:()=>a(K,null,[a(_l,ee({ref:c,modelValue:b.value,"onUpdate:modelValue":N=>b.value=N,activator:"parent",contentClass:"v-autocomplete__content",disabled:Y.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:me},e.menuProps),{default:()=>[T&&a(Rt,{ref:C,selected:A.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:N=>N.preventDefault(),onKeydown:H,onFocusin:ce,onFocusout:te,onScrollPassive:E,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var N,Z,J;return[(N=l["prepend-item"])==null?void 0:N.call(l),!F.value.length&&!e.hideNoData&&(((Z=l["no-data"])==null?void 0:Z.call(l))??a(Oe,{title:o(e.noDataText)},null)),a(Vl,{ref:f,renderless:!0,items:F.value},{default:ve=>{var Qe;let{item:le,index:ae,itemRef:Ht}=ve;const We=ee(le.props,{ref:Ht,key:ae,active:q.value&&ae===0?!0:void 0,onClick:()=>fe(le)});return((Qe=l.item)==null?void 0:Qe.call(l,{item:le,index:ae,props:We}))??a(Oe,We,{prepend:Pe=>{let{isSelected:Te}=Pe;return a(K,null,[e.multiple&&!e.hideSelected?a(kl,{key:le.value,modelValue:Te,ripple:!1,tabindex:"-1"},null):void 0,le.props.prependIcon&&a(he,{icon:le.props.prependIcon},null)])},title:()=>{var Pe,Te;return i.value?le.title:ua(le.title,(Pe=U(le))==null?void 0:Pe.title,((Te=w.value)==null?void 0:Te.length)??0)}})}}),(J=l["append-item"])==null?void 0:J.call(l)]}})]}),I.value.map((N,Z)=>{var le;function J(ae){ae.stopPropagation(),ae.preventDefault(),fe(N)}const ve={"onClick:close":J,onMousedown(ae){ae.preventDefault(),ae.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return a("div",{key:N.value,class:["v-autocomplete__selection",Z===y.value&&["v-autocomplete__selection--selected",k.value]],style:Z===y.value?p.value:{}},[m?l.chip?a($e,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:N.title}}},{default:()=>{var ae;return[(ae=l.chip)==null?void 0:ae.call(l,{item:N,index:Z,props:ve})]}}):a(ct,ee({key:"chip",closable:e.closableChips,size:"small",text:N.title},ve),null):((le=l.selection)==null?void 0:le.call(l,{item:N,index:Z}))??a("span",{class:"v-autocomplete__selection-text"},[N.title,e.multiple&&Z<I.value.length-1&&a("span",{class:"v-autocomplete__selection-comma"},[de(",")])])])})]),"append-inner":function(){var ve;for(var N=arguments.length,Z=new Array(N),J=0;J<N;J++)Z[J]=arguments[J];return a(K,null,[(ve=l["append-inner"])==null?void 0:ve.call(l,...Z),e.menuIcon?a(he,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:W,onClick:Cl,"aria-label":o(r.value),title:o(r.value)},null):void 0])}})}),De({isFocused:u,isPristine:i,menu:b,search:w,filteredItems:P,select:fe},n)}}),sa=ne({__name:"lookupField",props:{colInfo:{type:Object,required:!0},rules:{type:Array},readonly:{type:Boolean,required:!0},value:Object,async:{type:Boolean,default:!0}},setup(e){const t=e,l=Ne("$mainUrl"),o=V([g=>!!g||!t.colInfo.required||"Required !"]);if(t.rules)for(const g of t.rules)o.value.push(g);const n=V(),u=V(!1),i=V([]),d=V(t.value);let c;xe(async()=>{var g,b;await f(100),t.value&&!Array.isArray(t.value)&&!((g=i.value)!=null&&g.length)&&t.colInfo.type!="LookupMulti"?i.value.push(t.value):t.colInfo&&t.colInfo.type=="LookupMulti"&&Array.isArray(t.value)&&t.value.length&&!((b=i.value)!=null&&b.length)&&(i.value=t.value)});const f=async(g,b)=>{if(!t.colInfo.lookupField||!t.colInfo.lookupList)throw"Not a lookup field ?!";const y=await X.get(l+"/_api/web/lists(guid'"+t.colInfo.lookupList+"')/items",{params:{$select:["Id",t.colInfo.lookupField].join(","),$filter:b?"substringof('"+b+"',"+t.colInfo.lookupField+")":void 0,$top:g}});for(let x of y.data.value)i.value.push({title:x[t.colInfo.lookupField],value:x.Id})};return t.async&&!t.readonly&&Q(n,g=>{g&&g.length>2&&(clearTimeout(c),c=setTimeout(async()=>{u.value=!0,i.value=[],await f(25,g),u.value=!1},500))}),(g,b)=>t.async?($(),z(zt,{key:0,modelValue:d.value,"onUpdate:modelValue":[b[0]||(b[0]=y=>d.value=y),b[2]||(b[2]=y=>g.$emit("input",d.value))],items:i.value,loading:u.value,search:n.value,"onUpdate:search":b[1]||(b[1]=y=>n.value=y),"no-filter":"",chips:"","closable-chips":t.colInfo.type=="LookupMulti",label:t.colInfo.label,required:t.colInfo.required,placeholder:"Start typing to Search","prepend-icon":"mdi-table-search","return-object":"","cache-items":"",multiple:t.colInfo.type=="LookupMulti",rules:o.value,"prepend-inner-icon":t.colInfo.required&&!d.value?"mdi-alert-decagram-outline":void 0,readonly:t.readonly},null,8,["modelValue","items","loading","search","closable-chips","label","required","multiple","rules","prepend-inner-icon","readonly"])):($(),z(qt,{key:1,modelValue:d.value,"onUpdate:modelValue":[b[3]||(b[3]=y=>d.value=y),b[4]||(b[4]=y=>g.$emit("input",d.value))],label:t.colInfo.label,required:t.colInfo.required,items:i.value,multiple:t.colInfo.type=="LookupMulti",rules:o.value,"return-object":"","prepend-inner-icon":t.colInfo.required&&!d.value?"mdi-alert-decagram-outline":void 0,readonly:t.readonly},null,8,["modelValue","label","required","items","multiple","rules","prepend-inner-icon","readonly"]))}}),ra=oe(sa,[["__file","lookupField.vue"]]),da=ne({__name:"peopleField",props:{colInfo:{type:Object,required:!0},rules:{type:Array},readonly:{type:Boolean,required:!0},value:Object},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=Ke(),n=Ne("$mainUrl"),u=V([s=>!!s||!l.colInfo.required||"Required !"]);if(l.rules)for(const s of l.rules)u.value.push(s);const i=V(),d=V(!1),c=V([]),f=V(l.value);let g;xe(async()=>{var s,v;l.value&&!Array.isArray(l.value)&&!((s=c.value)!=null&&s.length)&&l.colInfo.type!="UserMulti"?c.value.push(l.value):l.colInfo&&l.colInfo.type=="UserMulti"&&Array.isArray(l.value)&&l.value.length&&!((v=c.value)!=null&&v.length)&&(c.value=l.value),l.colInfo.userSelectionScope!="0"&&b(l.colInfo.userSelectionScope)});const b=async(s,v)=>{const _=await X.get(n+"/_api/Web/SiteGroups/GetById("+s+")/users",{params:{$select:["Title","Id"].join(","),$filter:v?"substringof('"+v[0].toUpperCase()+v.slice(1)+"',Title)":void 0,$orderby:"Title",$top:25}});for(let k of _.data.value)c.value.push({title:k.Title,value:k.Id})},y=async s=>{const v=await X.get(n+"/_api/web/sitegroups",{params:{$select:["Title","Id"].join(","),$filter:s?"substringof('"+s[0].toUpperCase()+s.slice(1)+"',Title)":void 0,$orderby:"Title",$top:25}});for(let _ of v.data.value)c.value.push({title:_.Title,value:_.Id})},x=async s=>{const v=await X.post(n+"/_api/SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser",JSON.stringify({queryParams:{__metadata:{type:"SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"},AllowEmailAddresses:!0,AllowMultipleEntities:!1,AllUrlZones:!1,MaximumEntitySuggestions:50,PrincipalSource:15,PrincipalType:15,QueryString:s,Required:!1}}),{headers:o.createHeaders});return JSON.parse(v.data.d.ClientPeoplePickerSearchUser)};l.readonly||(Q(i,s=>{s&&s.length>3&&(clearTimeout(g),g=setTimeout(async()=>{if(d.value=!0,c.value=[],l.colInfo.userSelectionScope=="0"){const v=await x(s);c.value=v.map(_=>({title:_.DisplayText,value:_.Key})),l.colInfo.userSelectionMode=="PeopleAndGroups"&&await y(s)}else await b(l.colInfo.userSelectionScope,s);d.value=!1},500))}),Q(f,async()=>{if(Array.isArray(f.value))for(const s in f.value)f.value[s]=await r(f.value[s]);else f.value&&(f.value=await r(f.value));t("update:modelValue",f)}));const r=async s=>{var v;if(typeof s.value=="string"){const _=await X.post(n+"/_api/web/ensureuser('"+encodeURIComponent(s.value)+"')",{},{headers:o.createHeaders});return{title:s.title,value:(v=_.data.d)==null?void 0:v.Id}}else return s};return(s,v)=>($(),z(zt,{modelValue:f.value,"onUpdate:modelValue":v[0]||(v[0]=_=>f.value=_),items:c.value,loading:d.value,search:i.value,"onUpdate:search":v[1]||(v[1]=_=>i.value=_),"no-filter":"",chips:"","closable-chips":l.colInfo.type=="UserMulti",label:l.colInfo.label,required:l.colInfo.required,placeholder:"Start typing to Search","prepend-icon":"mdi-account-search","append-outer-icon":"","return-object":"","cache-items":"",multiple:l.colInfo.type=="UserMulti",rules:u.value,"prepend-inner-icon":l.colInfo.required&&!f.value?"mdi-alert-decagram-outline":void 0,readonly:l.readonly},null,8,["modelValue","items","loading","search","closable-chips","label","required","multiple","rules","prepend-inner-icon","readonly"]))}}),ca=oe(da,[["__file","peopleField.vue"]]);const fa=ie({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...He(),...ut()},"VTextarea"),va=ue()({name:"VTextarea",directives:{Intersect:Sl},inheritAttrs:!1,props:fa(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:l,emit:o,slots:n}=t;const u=ye(e,"modelValue"),{isFocused:i,focus:d,blur:c}=st(e),f=R(()=>typeof e.counterValue=="function"?e.counterValue(u.value):(u.value||"").toString().length),g=R(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function b(A,O){var q,Y;!e.autofocus||!A||(Y=(q=O[0].target)==null?void 0:q.focus)==null||Y.call(q)}const y=V(),x=V(),r=pe(""),s=V(),v=R(()=>e.persistentPlaceholder||i.value||e.active);function _(){var A;s.value!==document.activeElement&&((A=s.value)==null||A.focus()),i.value||d()}function k(A){_(),o("click:control",A)}function p(A){o("mousedown:control",A)}function w(A){A.stopPropagation(),_(),ge(()=>{u.value="",vt(e["onClick:clear"],A)})}function M(A){var q;const O=A.target;if(u.value=O.value,(q=e.modelModifiers)!=null&&q.trim){const Y=[O.selectionStart,O.selectionEnd];ge(()=>{O.selectionStart=Y[0],O.selectionEnd=Y[1]})}}const B=V(),P=V(+e.rows),U=R(()=>["plain","underlined"].includes(e.variant));wl(()=>{e.autoGrow||(P.value=+e.rows)});function I(){e.autoGrow&&ge(()=>{if(!B.value||!x.value)return;const A=getComputedStyle(B.value),O=getComputedStyle(x.value.$el),q=parseFloat(A.getPropertyValue("--v-field-padding-top"))+parseFloat(A.getPropertyValue("--v-input-padding-top"))+parseFloat(A.getPropertyValue("--v-field-padding-bottom")),Y=B.value.scrollHeight,C=parseFloat(A.lineHeight),E=Math.max(parseFloat(e.rows)*C+q,parseFloat(O.getPropertyValue("--v-input-control-height"))),H=parseFloat(e.maxRows)*C+q||1/0,D=Pl(Y??0,E,H);P.value=Math.floor((D-q)/C),r.value=xl(D)})}xe(I),Q(u,I),Q(()=>e.rows,I),Q(()=>e.maxRows,I),Q(()=>e.density,I);let F;return Q(B,A=>{A?(F=new ResizeObserver(I),F.observe(B.value)):F==null||F.disconnect()}),Fl(()=>{F==null||F.disconnect()}),se(()=>{const A=!!(n.counter||e.counter||e.counterValue),O=!!(A||n.details),[q,Y]=Ge(l),[{modelValue:C,...E}]=be.filterProps(e),[H]=rt(e);return a(be,ee({ref:y,modelValue:u.value,"onUpdate:modelValue":D=>u.value=D,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--plain-underlined":U.value},e.class],style:e.style},q,E,{centerAffix:P.value===1&&!U.value,focused:i.value}),{...n,default:D=>{let{isDisabled:G,isDirty:W,isReadonly:ke,isValid:Ce}=D;return a(dt,ee({ref:x,style:{"--v-textarea-control-height":r.value},onClick:k,onMousedown:p,"onClick:clear":w,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},H,{active:v.value||W.value,centerAffix:P.value===1&&!U.value,dirty:W.value||e.dirty,disabled:G.value,focused:i.value,error:Ce.value===!1}),{...n,default:Se=>{let{props:{class:me,...ce}}=Se;return a(K,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),Le(a("textarea",ee({ref:s,class:me,value:u.value,onInput:M,autofocus:e.autofocus,readonly:ke.value,disabled:G.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:_,onBlur:c},ce,Y),null),[[xt("intersect"),{handler:b},null,{once:!0}]]),e.autoGrow&&Le(a("textarea",{class:[me,"v-textarea__sizer"],id:`${ce.id}-sizer`,"onUpdate:modelValue":te=>u.value=te,ref:B,readonly:!0,"aria-hidden":"true"},null),[[Al,u.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:O?D=>{var G;return a(K,null,[(G=n.details)==null?void 0:G.call(n,D),A&&a(K,null,[a("span",null,null),a(ft,{active:e.persistentCounter||i.value,value:f.value,max:g.value},n.counter)])])}:void 0})}),De({},y,x,s)}}),ma=ne({__name:"textAreaField",props:{colInfo:{type:Object,required:!0},rules:{type:Array},readonly:{type:Boolean,required:!0},rows:{type:String,required:!0,default:"3"},value:String},setup(e){const t=e,l=V([n=>!!n||!t.colInfo.required||"Required !"]);if(t.rules)for(const n of t.rules)l.value.push(n);const o=V(t.value);return(n,u)=>($(),z(va,{modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=i=>o.value=i),filled:"",rows:t.rows,label:t.colInfo.label,required:t.colInfo.required,rules:t.rules,readonly:t.readonly,"prepend-inner-icon":t.colInfo.required&&!o.value?"mdi-alert-decagram-outline":void 0,onInput:u[1]||(u[1]=i=>n.$emit("input",o.value))},null,8,["modelValue","rows","label","required","rules","readonly","prepend-inner-icon"]))}}),pa=oe(ma,[["__file","textAreaField.vue"]]),ya=ne({__name:"selectField",props:{colInfo:{type:Object,required:!0},rules:{type:Array},readonly:{type:Boolean,required:!0},value:String},setup(e){const t=e,l=V([n=>!!n||!t.colInfo.required||"Required !"]);if(t.rules)for(const n of t.rules)l.value.push(n);const o=V(t.value);return(n,u)=>($(),z(qt,{modelValue:o.value,"onUpdate:modelValue":[u[0]||(u[0]=i=>o.value=i),u[1]||(u[1]=i=>n.$emit("input",o.value))],label:t.colInfo.label,required:t.colInfo.required,items:t.colInfo.choices,multiple:t.colInfo.type=="MultiChoice",rules:l.value,"return-object":"","prepend-inner-icon":e.colInfo.required&&!o.value?"mdi-alert-decagram-outline":void 0,readonly:t.readonly},null,8,["modelValue","label","required","items","multiple","rules","prepend-inner-icon","readonly"]))}}),ga=oe(ya,[["__file","selectField.vue"]]),ba=ie({...Tl({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Ia=ue()({name:"VRadio",props:ba(),setup(e,t){let{slots:l}=t;return se(()=>a(Dt,ee(e,{class:["v-radio",e.class],style:e.style,type:"radio"}),l)),{}}});const ha=ie({height:{type:[Number,String],default:"auto"},...He(),...$t(Ul(),["multiple"]),trueIcon:{type:_e,default:"$radioOn"},falseIcon:{type:_e,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),_a=ue()({name:"VRadioGroup",inheritAttrs:!1,props:ha(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:l,slots:o}=t;const n=Rl(),u=R(()=>e.id||`radio-group-${n}`),i=ye(e,"modelValue");return se(()=>{const[d,c]=Ge(l),[f,g]=be.filterProps(e),[b,y]=Dt.filterProps(e),x=o.label?o.label({label:e.label,props:{for:u.value}}):e.label;return a(be,ee({class:["v-radio-group",e.class],style:e.style},d,f,{modelValue:i.value,"onUpdate:modelValue":r=>i.value=r,id:u.value}),{...o,default:r=>{let{id:s,messagesId:v,isDisabled:_,isReadonly:k}=r;return a(K,null,[x&&a($l,{id:s.value},{default:()=>[x]}),a(ql,ee(b,{id:s.value,"aria-describedby":v.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:_.value,readonly:k.value,"aria-labelledby":x?s.value:void 0,multiple:!1},c,{modelValue:i.value,"onUpdate:modelValue":p=>i.value=p}),o)])}})}),{}}}),Va=ne({__name:"radioField",props:{colInfo:{type:Object,required:!0},rules:{type:Array},readonly:{type:Boolean,required:!0},inline:{type:Boolean,default:!0},value:String},setup(e){const t=e,l=V([n=>!!n||!t.colInfo.required||"Required !"]);if(t.rules)for(const n of t.rules)l.value.push(n);const o=V(t.value);return(n,u)=>($(),z(_a,{modelValue:o.value,"onUpdate:modelValue":[u[0]||(u[0]=i=>o.value=i),u[1]||(u[1]=i=>n.$emit("input",o.value))],row:"",rules:l.value,label:t.colInfo.label,"prepend-inner-icon":t.colInfo.required&&!o.value?"mdi-alert-decagram-outline":void 0,readonly:t.readonly,inline:t.inline},{default:h(()=>[($(!0),Fe(K,null,Ae(t.colInfo.choices,i=>($(),z(Ia,{key:i,label:i,value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue","rules","label","prepend-inner-icon","readonly","inline"]))}}),ka=oe(Va,[["__file","radioField.vue"]]),Ca=ne({__name:"dateField",props:{colInfo:{type:Object,required:!0},rules:{type:Array},readonly:{type:Boolean,required:!0},value:String},setup(e){const t=e,l=V([n=>!!n||!t.colInfo.required||"Required !"]);if(t.rules)for(const n of t.rules)l.value.push(n);const o=V(t.value);return(n,u)=>($(),z(qe,{modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=i=>o.value=i),type:t.colInfo.format=="DateTime"?"datetime-local":"date","prepend-inner-icon":t.colInfo.required&&!o.value?"mdi-alert-decagram-outline":void 0,label:t.colInfo.label,required:t.colInfo.required,rules:l.value,readonly:t.readonly,onInput:u[1]||(u[1]=i=>n.$emit("input",o.value))},null,8,["modelValue","type","prepend-inner-icon","label","required","rules","readonly"]))}}),Sa=oe(Ca,[["__file","dateField.vue"]]),wa=ne({__name:"textField",props:{colInfo:{type:Object,required:!0},rules:{type:Array},readonly:{type:Boolean,required:!0},value:String},setup(e){const t=e,l=V([n=>{var u;return!!n||!((u=t.colInfo)!=null&&u.required)||"Required !"}]);if(t.rules)for(const n of t.rules)l.value.push(n);const o=V(t.value);return(n,u)=>($(),z(qe,{modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=i=>o.value=i),label:t.colInfo.label,required:t.colInfo.required,rules:l.value,readonly:t.readonly,"prepend-inner-icon":t.colInfo.required&&!o.value?"mdi-alert-decagram-outline":void 0,onInput:u[1]||(u[1]=i=>n.$emit("input",o.value))},null,8,["modelValue","label","required","rules","readonly","prepend-inner-icon"]))}}),Fa=oe(wa,[["__file","textField.vue"]]),Et=Dl("form",()=>{const e=V(),t=V([]),l=V([]),o=V();return{formData:e,init:(i,d)=>{e.value={...i},o.value=d},columns:o,getCol:i=>{var d;return(d=o.value)==null?void 0:d.find(c=>c.staticName==i)},filesToRemove:t,filesToUpload:l}}),Aa=(e,t)=>{const l=Ne("$mainUrl"),o=V(!1),n=Et(),u=Ke(),{getListItemType:i,getFileBuffer:d}=je(),c=(r,s)=>{let v={};for(let[_,k]of Object.entries(r)){const p=s.find(w=>w.staticName==_);if(p)switch(p.type){case"MultiChoice":k={results:k.filter(w=>w)};break;case"DateTime":k=k||void 0;break;case"LookupMulti":k={results:k?k.map(w=>w.value):[]},_+="Id";break;case"Lookup":_+="Id",typeof k=="object"?k=k?k.value:void 0:k||(k=void 0);break;case"UserMulti":k={results:k?k.map(w=>w.value):[]},_+="Id";break;case"User":_+="Id",k=k?k.value:void 0;break;case"Number":k=k||void 0;break}k!=null&&p&&p.type!="Counter"&&p.type!="Computed"&&(v=Object.assign({},v,{[_]:k}))}return v},f=async()=>{if(!n.columns)throw"Form not initialize ?";const r=await i(e);let s=c(n.formData,n.columns);return s.__metadata=r,t?(s.ID=t,await X.post(l+"/_api/web/lists/getByTitle('"+e+"')/items("+t+")",JSON.stringify(s),{headers:u.updateHeaders})):t=(await X.post(l+"/_api/web/lists/getByTitle('"+e+"')/items",JSON.stringify(s),{headers:u.createHeaders})).data.d.Id,t},g=async()=>{if(!t)throw"item id missing ?";for(let r of n.filesToUpload)for(let s of r){await new Promise(k=>setTimeout(k,500));let v=encodeURIComponent(s.name).replace(/'/g,"%27%27"),_=await d(s);await X.post(l+"/_api/web/lists/getByTitle('"+e+"')/items("+t+")/AttachmentFiles/add(FileName='"+v+"')",_,{headers:u.createHeaders})}},b=async()=>{if(!t)throw"item id missing ?";for(let r of n.filesToRemove){let s=encodeURIComponent(r).replace(/'/g,"%27%27");await X.delete(l+"/_api/web/lists/getByTitle('"+e+"')/items("+t+")/AttachmentFiles('"+s+"')",{headers:u.deleteHeaders})}},y=async r=>{const s=await i(r.props.listName);for(let v of r.mainItems){let _=c(v,r.columns);_.__metadata=s,v.id!=-1?(_.ID=v.id,await X.post(l+"/_api/web/lists/getByTitle('"+r.props.listName+"')/items("+v.id+")",JSON.stringify(_),{headers:u.updateHeaders})):(_[r.props.lookupColumn]=t,await X.post(l+"/_api/web/lists/getByTitle('"+r.props.listName+"')/items",JSON.stringify(_),{headers:u.createHeaders}))}for(let v of r.deletedItems)await X.delete(l+"/_api/web/lists/getByTitle('"+r.props.listName+"')/items("+v+")",{headers:u.deleteHeaders})};return{saveEverything:async r=>{o.value=!0;try{if(await f(),await g(),await b(),r)for(const s of r)await y(s)}catch(s){return s&&u.setAlert("red",JSON.stringify(s)),!1}finally{o.value=!1}return!0},saving:o}},xa=ie({...Ve(),...Nl()},"VForm"),Pa=ue()({name:"VForm",props:xa(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,t){let{slots:l,emit:o}=t;const n=Ml(e),u=V();function i(c){c.preventDefault(),n.reset()}function d(c){const f=c,g=n.validate();f.then=g.then.bind(g),f.catch=g.catch.bind(g),f.finally=g.finally.bind(g),o("submit",f),f.defaultPrevented||g.then(b=>{var x;let{valid:y}=b;y&&((x=u.value)==null||x.submit())}),f.preventDefault()}return se(()=>{var c;return a("form",{ref:u,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:i,onSubmit:d},[(c=l.default)==null?void 0:c.call(l,n)])}),De(n,u)}}),at="Lista Testowa",Ta=ne({__name:"listForm",setup(e){const t=Et(),l=Ke(),o=V(["Title","PackedDate","ChoiceRadio","Status","Liczby","Realizujacy","MultiUsers","FromGroup","App"]),n=V(!1),u=Bl(),i=Array.isArray(u.params.id)?u.params.id[0]:u.params.id,{columns:d,columnNames:c,readOnlyFields:f,editableFields:g,initForm:b,getCol:y}=Lt(at,o.value,i?"Id eq "+i:void 0),x=V(!1),r=V(null),{saveEverything:s,saving:v}=Aa(at,i);xe(async()=>{await b(),t.init(g.value[0],d.value),n.value=!0});const _=async()=>{x.value?(console.log(r.value),await s([Pt(r.value)])):l.setAlert("red","Invalid Form !")};return(k,p)=>{const w=Tt("v-skeleton-loader"),M=Fa,B=Sa,P=ka,U=ga,I=pa,F=ca,A=ra,O=oa,q=aa,Y=Jl;return $(),z(Xl,{class:"mx-auto",loading:S(v)||!n.value},{default:h(()=>[n.value?($(),z(Pa,{key:1,modelValue:x.value,"onUpdate:modelValue":p[12]||(p[12]=C=>x.value=C),"lazy-validation":"",onSubmit:p[13]||(p[13]=Ll(C=>_(),["prevent"])),disabled:S(v)},{default:h(()=>[a(Re,null,{default:h(()=>[a(Ue,null,{default:h(()=>[a(j,{cols:"12",md:"4"},{default:h(()=>[a(M,{modelValue:S(t).formData.Title,"onUpdate:modelValue":p[0]||(p[0]=C=>S(t).formData.Title=C),colInfo:S(y)("Title"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(M,{modelValue:S(t).formData.Liczby,"onUpdate:modelValue":p[1]||(p[1]=C=>S(t).formData.Liczby=C),colInfo:S(y)("Liczby"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(B,{modelValue:S(t).formData.PackedDate,"onUpdate:modelValue":p[2]||(p[2]=C=>S(t).formData.PackedDate=C),colInfo:S(y)("PackedDate"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(P,{modelValue:S(t).formData.ChoiceRadio,"onUpdate:modelValue":p[3]||(p[3]=C=>S(t).formData.ChoiceRadio=C),colInfo:S(y)("ChoiceRadio"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(U,{modelValue:S(t).formData.Status,"onUpdate:modelValue":p[4]||(p[4]=C=>S(t).formData.Status=C),colInfo:S(y)("Status"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(I,{modelValue:S(t).formData.PanelAkcji,"onUpdate:modelValue":p[5]||(p[5]=C=>S(t).formData.PanelAkcji=C),colInfo:S(y)("PanelAkcji"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(F,{modelValue:S(t).formData.Realizujacy,"onUpdate:modelValue":p[6]||(p[6]=C=>S(t).formData.Realizujacy=C),colInfo:S(y)("Realizujacy"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(F,{modelValue:S(t).formData.MultiUsers,"onUpdate:modelValue":p[7]||(p[7]=C=>S(t).formData.MultiUsers=C),colInfo:S(y)("MultiUsers"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(F,{modelValue:S(t).formData.FromGroup,"onUpdate:modelValue":p[8]||(p[8]=C=>S(t).formData.FromGroup=C),colInfo:S(y)("FromGroup"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),a(j,{cols:"12",md:"4"},{default:h(()=>[a(A,{modelValue:S(t).formData.App,"onUpdate:modelValue":p[9]||(p[9]=C=>S(t).formData.App=C),colInfo:S(y)("App"),readonly:!1},null,8,["modelValue","colInfo"])]),_:1}),S(f).length&&S(u).params.id?($(),z(j,{key:0,cols:"12",md:"4"},{default:h(()=>[a(O,{"saved-files":S(f)[0].attachmentFiles,filesToRemove:S(t).filesToRemove,"onUpdate:filesToRemove":p[10]||(p[10]=C=>S(t).filesToRemove=C)},null,8,["saved-files","filesToRemove"])]),_:1})):Je("",!0),a(j,{cols:"12"},{default:h(()=>[a(q,{ref_key:"iteratorTest",ref:r,listName:"Lista testowa 2",queryFilter:"Parent/Id eq ",keyColumn:"Title",lookupColumn:"ParentId",parentId:S(i),readonly:!1,editableColumns:["Title","Tester","App","Flow"]},{Title:h(({value:C,column:E,index:H,update:D,key:G})=>[a(j,{cols:"12",md:"4"},{default:h(()=>[a(M,{value:C,onInput:W=>D(W,H,G),colInfo:E,readonly:!1},null,8,["value","onInput","colInfo"])]),_:2},1024)]),Tester:h(({value:C,column:E,index:H,update:D,key:G})=>[a(j,{cols:"12",md:"4"},{default:h(()=>[a(F,{value:C,onInput:W=>D(W,H,G),colInfo:E,readonly:!1},null,8,["value","onInput","colInfo"])]),_:2},1024)]),App:h(({value:C,column:E,index:H,update:D,key:G})=>[a(j,{cols:"12",md:"4"},{default:h(()=>[a(A,{value:C,onInput:W=>D(W,H,G),colInfo:E,readonly:!1},null,8,["value","onInput","colInfo"])]),_:2},1024)]),Flow:h(({value:C,column:E,index:H,update:D,key:G})=>[a(j,{cols:"12",md:"4"},{default:h(()=>[a(U,{value:C,onInput:W=>D(W,H,G),colInfo:E,readonly:!1},null,8,["value","onInput","colInfo"])]),_:2},1024)]),_:1},8,["parentId"])]),_:1})]),_:1}),a(Y,{filesToUpload:S(t).filesToUpload,"onUpdate:filesToUpload":p[11]||(p[11]=C=>S(t).filesToUpload=C)},null,8,["filesToUpload"])]),_:1}),a(Ot,null,{default:h(()=>[a(Gt),a(Ie,{color:"success",class:"mr-4",type:"submit",variant:"flat",loading:S(v)},{default:h(()=>[de(" Save ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue","disabled"])):($(),z(w,{key:0}))]),_:1},8,["loading"])}}}),Ua=oe(Ta,[["__file","listForm.vue"]]),Ra=ne({__name:"Form",setup(e){return(t,l)=>($(),z(Re,{fluid:""},{default:h(()=>[a(Ua)]),_:1}))}}),Da=oe(Ra,[["__file","Form.vue"]]);export{Da as default};
